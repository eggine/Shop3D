<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>首页</title>

   <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/carousel.css" rel="stylesheet">
  <link href="css/store.css" rel="stylesheet">
  <link href="css/font-awesome.min.css" rel="stylesheet">
  <link href="css/sendi_loading_wave.css" rel="stylesheet"> 
  

  <!-- -----------------------produce mode------------------------ 
  <link href="${path}/views/admin/css/bootstrap.min.css" rel="stylesheet">
  <link href="${path}/views/admin/css/carousel.css" rel="stylesheet">
  <link href="${path}/views/admin/css/store.css" rel="stylesheet">
  <link href="${path}/views/admin/css/sendi_loading_wave.css" rel="stylesheet">-->
  
  <script type="text/javascript">
  var urlParams = (function(url)
      {
        var result = new Object();
        var idx = url.lastIndexOf('?');
    
        if (idx > 0)
        {
          var params = url.substring(idx + 1).split('&');
          
          for (var i = 0; i < params.length; i++)
          {
            idx = params[i].indexOf('=');
            
            if (idx > 0)
            {
              result[params[i].substring(0, idx)] = params[i].substring(idx + 1);
            }
          }
        }
        
        return result;

      })(window.location.href);

      var name = urlParams['name'];
  </script>

  
   <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/CustomUtils.js"></script>
  <script src="js/ImgLoadAlgorithmForEdit.js"></script>
  <script src="js/renderPanel.js"></script>
   <script type="text/javascript"  src="js/sendi-jquery-loading-1.0.js"></script> 
   <!-- -------------------------------produce mode--------------------------------------------- -->
  <!--
  <script src="${path}/views/admin/js/jquery.min.js"></script>
  <script src="${path}/views/admin/js/sendi-jquery-loading-1.0.js"></script>
  <script src="${path}/views/admin/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="${path}/views/admin/js/CustomUtils.js"></script>
  <script src="${path}/views/admin/js/ImgLoadAlgorithmForEdit.js"></script>
  <script src="${path}/views/admin/js/renderPanel.js"></script>-->
  
  
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body style="padding-bottom:0px">
<input type="hidden" id="itemname" value="">
   <div id="chooseFieldModal" class="modal fade bs-example-modal-sm " tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
     <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title">默认方案结果</h4>
      </div>
      <div class="modal-body"">
          <p><label>默认方案:</label> <span id="default-scheme"  style="color:#FF0000">000-00--00--000</span></p>
          <p><label>默认图片视角:</label> <span id="default-vision"  style="color:#FF0000">43</span></p>
          <p><label>默认图片:</label> <span id="default-imgs" style="color:#FF0000">43,43,43,43,43</span></p>
      </div>
      <div class="modal-footer">
          <button id="comfirm-btn" type="button" class="btn btn-success">确定</button>
      </div>
    </div>
  </div>
</div>
  <div class="col-md-12" style="height:50px;line-height:50px;font-size:25px;text-align:center;background:#DDDDDD;color:#FFFFFF">默认方案编辑</div>
  <div class="container-fluid" style="">
    <div class="row" style="margin-top:20px">
      <div class="col-md-9" style="overflow:hidden">

          <div id="imgcontainer" class="img-container">
            <div class="position-item">00</div>
            <div class="position-item">10</div>
            <div class="position-item">20</div>
            <div class="position-item">30</div>
            <div class="position-item">40</div>
            <div class="position-item">50</div>
            <div class="position-item">60</div>
            <div class="position-item">70</div>
            <div class="position-item">01</div>
            <div class="position-item">11</div>
            <div class="position-item">21</div>
            <div class="position-item">31</div>
            <div class="position-item">41</div>
            <div class="position-item">51</div>
            <div class="position-item">61</div>
            <div class="position-item">71</div>
            <div class="position-item">02</div>
            <div class="position-item">12</div>
            <div class="position-item">22</div>
            <div class="position-item">32</div>
            <div class="position-item">42</div>
            <div class="position-item">52</div>
            <div class="position-item">62</div>
            <div class="position-item">72</div>
            <div class="position-item">03</div>
            <div class="position-item">13</div>
            <div class="position-item">23</div>
            <div class="position-item">33</div>
            <div class="position-item">43</div>
            <div class="position-item">53</div>
            <div class="position-item">63</div>
            <div class="position-item">73</div>

          </div>
         
    
      </div><!-- col-md-9 end -->


      <div class="col-md-3">
        <div class="produce-title">
          <h4 id="produceName" >Channel平底鞋</h4>
          <span id="producePrice">$3000</span>
        </div>
        <div class="choose-panel-content">
          <select id="componentNames" class="form-control newselect">
           
          </select>

          <div id="materialContent" class="choose-panel-material-content">
            

          </div>
        
        </div>



        <div class="choose-panel-footer">
          <div class="btn-group btn-group-justified mt10" role="group" aria-label="">
            <div class="btn-group" role="group" style="width:100%">
              <button id="saveScheme" type="button" class="btn btn-lg btn-default bluebutton" style="width:100%">保存</button>
            </div>

          </div>


        </div>

      </div>


    </div>
    <!-- /.row -->
    <hr class="featurette-divider">
    <!-- FOOTER -->

  </div>
  <!-- /.container -->

  <script type="text/javascript">
        $(document).ready(function(){
        	var itemname;
        		var query = location.search.substring(1);
        		var values= query.split("&"); 
        		for(var i = 0; i < values.length; i++) {
        		var pos = values[i].indexOf('='); 
        		if (pos == -1) continue; 
        		var paramname = values[i].substring(0,pos);
        		if("name"==paramname){
        			itemname= values[i].substring(pos+1); 	
        			}
        		} 
        	$('#itemname').attr('value',itemname);
            renderPanel();
            
            $('#saveScheme').on('click',function(){
                 var defaultScheme = generateScheme();
                 console.debug('defaultScheme:'+defaultScheme);
                 var default_imgno = '';
                 var items = $('.position-item');
                 for(var i = 0; i < items.length; i++){
                    if($(items[i]).hasClass('position-item-selected')){
                       default_imgno = $(items[i]).html();
                       break;
                    }
                 }
                 console.debug('imgno:'+default_imgno);
                 
                 if(default_imgno == ''){
                 
                    alert('请选择默认视角！！');
                 }else{
                 
                   var algorithm = new ImgLoadAlgorithmForEdit(default_imgno);
                   var left = algorithm.getLeftImgNo();
                   var right = algorithm.getRightImgNo();
                   var up = algorithm.getUpImgNo();
                   var down = algorithm.getDownImgNo();
                   var default_pos = left+','+right+','+up+','+down+','+default_imgno;
                   console.debug('default_pos:'+default_pos);
                   $('#default-scheme').html(defaultScheme);
                   $('#default-imgs').html(default_pos);
                   $('#default-vision').html(default_imgno);
                   $('#chooseFieldModal').modal('show');
                 
                 }
                 
                 
            });
            
            
            
            $('.position-item').on('click',function(){
            
                 if(!$(this).hasClass('position-item-selected')){
                     
                     $('.position-item').removeClass('position-item-selected');
                     $(this).addClass('position-item-selected');
                 
                 }
            
            });
            
            
            
            $('#comfirm-btn').on('click',function(){
                
                var scheme = $('#default-scheme').html();
                var imgs = $('#default-imgs').html();
                var vision = $('#default-vision').html();
                console.debug('scheme:'+scheme);
                console.debug('imgs:'+imgs);
                console.debug('vision:'+vision);
               
                $.ajax({
                
	                 url:'http://localhost:8080/aserver/Custom/initDefaultCustom',
	                 data:{'scheme':scheme,'imgs':imgs,'vision':vision,'itemid':name},
	                 dataType:'json',
	                 type:'POST',
	                 success:function(json){
	                	 console.debug(json);
	                    if(json.result == 'success'){
	                       
	                          $('#chooseFieldModal').modal('hide');
	                          window.close();
	                    }else{
	                    alert("error");
	                          $('#chooseFieldModal').modal('hide');
	                    }
	                 },
	                 error:function(){
	                 
	                 
	                 }
                
                });
            
            
            });


        });



    </script>
</body>
</html>